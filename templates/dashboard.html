<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Easy Finance — Dashboard</title>
    <meta name="description" content="Your personal finance dashboard — track accounts, transactions, and spending.">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        (function() {
            const savedTheme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            document.documentElement.setAttribute('data-theme', savedTheme || (prefersDark ? 'dark' : 'light'));
            const savedDensity = localStorage.getItem('density');
            if (savedDensity) document.documentElement.setAttribute('data-density', savedDensity);
            const savedColorScheme = localStorage.getItem('color-scheme');
            if (savedColorScheme) document.documentElement.setAttribute('data-color-scheme', savedColorScheme);
        })();
    </script>
</head>
<body>
    <div class="app-container">
        <!-- ── Header ── -->
        <header class="app-header" id="app-header">
            <div class="header-inner">
                <div class="header-left">
                    <h1 class="header-title" id="dashboard-title">Easy Finance</h1>
                </div>
                <div class="header-right">
                    <div class="search-container" id="search-container">
                        <span class="material-icons-outlined search-icon">search</span>
                        <input type="search" id="search-bar" placeholder="Search accounts & transactions..." autocomplete="off">
                    </div>
                    <div class="header-actions">
                        <button class="icon-btn" id="open-categories-modal-btn" title="Categories">
                            <span class="material-icons-outlined">category</span>
                        </button>
                        <button class="icon-btn" id="open-recurring-modal-btn" title="Recurring">
                            <span class="material-icons-outlined">event_repeat</span>
                        </button>
                        <button class="icon-btn" id="open-import-modal-btn" title="Import">
                            <span class="material-icons-outlined">upload_file</span>
                        </button>
                        <button class="icon-btn" id="open-settings-modal-btn" title="Settings">
                            <span class="material-icons-outlined">tune</span>
                        </button>
                        <button class="icon-btn" id="theme-switcher" title="Toggle Theme">
                            <span class="material-icons-outlined icon-light-mode">light_mode</span>
                            <span class="material-icons-outlined icon-dark-mode">dark_mode</span>
                        </button>
                        <a href="{{ url_for('logout') }}" class="logout-button" title="Logout">
                            <span class="material-icons-outlined">logout</span>
                        </a>
                    </div>
                </div>
            </div>
        </header>

        <!-- ── Main Content ── -->
        <main class="main-content">
            <!-- Summary Cards -->
            <div class="dashboard-summary-grid" style="display: none;">
                <div class="summary-card balance-card" id="total-balance-card">
                    <div class="summary-card-icon">
                        <span class="material-icons-outlined">account_balance_wallet</span>
                    </div>
                    <div class="summary-card-content">
                        <span class="summary-card-label">Total Balance</span>
                        <p class="summary-card-value">$0.00</p>
                    </div>
                </div>
                <div class="summary-card income-card" id="total-income-card">
                    <div class="summary-card-icon">
                        <span class="material-icons-outlined">trending_up</span>
                    </div>
                    <div class="summary-card-content">
                        <span class="summary-card-label">Monthly Income</span>
                        <p class="summary-card-value">$0.00</p>
                    </div>
                </div>
                <div class="summary-card expense-card" id="total-expense-card">
                    <div class="summary-card-icon">
                        <span class="material-icons-outlined">trending_down</span>
                    </div>
                    <div class="summary-card-content">
                        <span class="summary-card-label">Monthly Expense</span>
                        <p class="summary-card-value">$0.00</p>
                    </div>
                </div>
            </div>

            <!-- Expense Chart & Recent Transactions -->
            <div class="dashboard-charts-row" style="display: none;">
                <div class="chart-card">
                    <h2 class="section-title">
                        <span class="material-icons-outlined">donut_large</span>
                        Expense Breakdown
                    </h2>
                    <div class="chart-wrapper">
                        <canvas id="expense-chart"></canvas>
                    </div>
                    <div class="chart-legend" id="expense-chart-legend"></div>
                </div>
                <div class="recent-transactions-card">
                    <h2 class="section-title">
                        <span class="material-icons-outlined">receipt_long</span>
                        Recent Transactions
                    </h2>
                    <ul class="transactions-list" id="recent-transactions-list"></ul>
                </div>
            </div>

            <!-- Accounts Section -->
            <div class="accounts-section">
                <div class="accounts-section-header">
                    <h2 class="section-title">
                        <span class="material-icons-outlined">credit_card</span>
                        My Accounts
                    </h2>
                    <button class="button-primary button-sm" id="open-add-account-modal-btn">
                        <span class="material-icons-outlined">add</span>
                        <span class="btn-label">Add Account</span>
                    </button>
                </div>
                <div id="accounts-container" class="accounts-grid"></div>
                <div id="no-results-message" class="no-results-message">
                    <span class="material-icons-outlined" style="font-size: 48px; display: block; margin-bottom: 0.5rem;">search_off</span>
                    No accounts or transactions match your search.
                </div>
            </div>
        </main>
    </div>

    {% include '_modals.html' %}

    <script type="module" src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
